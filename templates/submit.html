<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Results</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.3.2/dist/confetti.browser.min.js"></script>
</head>
<body>
    <div class="results-container">
        <h1>Your Quiz Results</h1>
        <h2>Your Score: <span id="score">0</span>/80</h2>
        <p id="message"></p>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            fetch('/submit_quiz', {
                method: 'POST',
                body: JSON.stringify(sessionStorage.getItem("user_answers")),
                headers: { "Content-Type": "application/json" }
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById("score").innerText = data.score;
                let messageBox = document.getElementById("message");

                if (data.message === "confetti") {
                    messageBox.innerText = "🎉 Congratulations! Amazing work!";
                    confetti({
                        particleCount: 150,
                        spread: 70,
                        origin: { y: 0.6 }
                    });
                } else if (data.message === "well_done") {
                    messageBox.innerText = "👏 Well done! Keep practicing.";
                } else {
                    messageBox.innerText = "⚠️ Check your answers carefully and try again!";
                }
            })
            .catch(error => console.error("Error fetching results:", error));
            
        });
    </script>
</body>
</html>
